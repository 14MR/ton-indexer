version: '3.3'
services:
  indexer:
    build:
      context: .
      dockerfile: deploy/indexer.Dockerfile
    environment:
      RABBITMQ_HOST: rabbitmq
      RABBITMQ_PORT: 5672
    depends_on:
      - rabbitmq
  rabbitmq:
    image: rabbitmq
    restart: unless-stopped
  scheduler:
    build:
      context: .
      dockerfile: deploy/scheduler.Dockerfile
    environment:
      RABBITMQ_HOST: rabbitmq
      RABBITMQ_PORT: 5672
      WORKERS_COUNT: 5
    depends_on:
      - indexer